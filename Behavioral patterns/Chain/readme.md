# üîó –ü–∞—Ç—Ç–µ—Ä–Ω Chain of Responsibility –Ω–∞ PHP  
_CoR, Chain of Command, Chain of Responsibility, —Ü–µ–ø–æ—á–∫–∞ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π_

![](https://refactoring.guru/images/patterns/content/chain-of-responsibility/chain-of-responsibility.png?id=56c10d0dc712546cc283cfb3fb463458)

## üß© –ê–Ω–∞–ª–æ–≥–∏—è –∏–∑ –∂–∏–∑–Ω–∏
**–ü—Ä–∏–º–µ—Ä –æ–±—â–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π**  
![](https://refactoring.guru/images/patterns/content/chain-of-responsibility/chain-of-responsibility-comic-1-ru.png?id=36f613d78baebc27d21d2a94deb3992f)
–í—ã –∫—É–ø–∏–ª–∏ –Ω–æ–≤—É—é –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É. –û–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∞—Å—å –∏ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∞ –ø–æ–¥ Windows, –Ω–æ –≤ –≤–∞—à–µ–π –ª—é–±–∏–º–æ–π Ubuntu ¬´–∑–∞–≤–µ—Å—Ç–∏¬ª –µ—ë –Ω–µ —É–¥–∞–ª–æ—Å—å. –°–æ —Å–ª–∞–±–æ–π –Ω–∞–¥–µ–∂–¥–æ–π –≤—ã –∑–≤–æ–Ω–∏—Ç–µ –≤ —Å–ª—É–∂–±—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏.    
–ü–µ—Ä–≤—ã–º –≤—ã —Å–ª—ã—à–∏—Ç–µ –≥–æ–ª–æ—Å –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç—á–∏–∫–∞, –ø—Ä–µ–¥–ª–∞–≥–∞—é—â–∏–π –≤—ã–±–æ—Ä –∏–∑ –¥–µ—Å—è—Ç–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π. –ù–∏ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç, –∏ —Ä–æ–±–æ—Ç —Å–æ–µ–¥–∏–Ω—è–µ—Ç –≤–∞—Å —Å –∂–∏–≤—ã–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º.    
–£–≤—ã, –Ω–æ —Ä—è–¥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —É–º–µ–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –∑–∞—É—á–µ–Ω–Ω—ã–º–∏ —Ñ—Ä–∞–∑–∞–º–∏ –∏ –¥–∞–≤–∞—Ç—å —à–∞–±–ª–æ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã. –ü–æ—Å–ª–µ –æ—á–µ—Ä–µ–¥–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è ¬´–≤—ã–∫–ª—é—á–∏—Ç—å –∏ –≤–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä¬ª –≤—ã –ø—Ä–æ—Å–∏—Ç–µ —Å–≤—è–∑–∞—Ç—å –≤–∞—Å —Å –Ω–∞—Å—Ç–æ—è—â–∏–º–∏ –∏–Ω–∂–µ–Ω–µ—Ä–∞–º–∏.    
–û–ø–µ—Ä–∞—Ç–æ—Ä –ø–µ—Ä–µ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∑–≤–æ–Ω–æ–∫ –¥–µ–∂—É—Ä–Ω–æ–º—É –∏–Ω–∂–µ–Ω–µ—Ä—É, –∏–∑–Ω—ã–≤–∞—é—â–µ–º—É –æ—Ç —Å–∫—É–∫–∏ –≤ —Å–≤–æ–µ–π –∫–∞–º–æ—Ä–∫–µ. –£–∂ –æ–Ω-—Ç–æ –∑–Ω–∞–µ—Ç, –∫–∞–∫ –≤–∞–º –ø–æ–º–æ—á—å! –ò–Ω–∂–µ–Ω–µ—Ä —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–º, –≥–¥–µ —Å–∫–∞—á–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞ –∏ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏—Ö –ø–æ–¥ Ubuntu. –ó–∞–ø—Ä–æ—Å —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω. –í—ã –∫–ª–∞–¥—ë—Ç–µ —Ç—Ä—É–±–∫—É.    
## üß† –û–ø–∏—Å–∞–Ω–∏–µ

–ü–∞—Ç—Ç–µ—Ä–Ω **Chain of Responsibility** (**–¶–µ–ø–æ—á–∫–∞ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π**) ‚Äî —ç—Ç–æ **–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π** –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ü–µ–ø–æ—á–∫—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –ø–æ —ç—Ç–æ–π —Ü–µ–ø–æ—á–∫–µ, –ø–æ–∫–∞ –æ–¥–∏–Ω –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –µ–≥–æ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä—è–º–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–º –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º, –∞ —Ç–∞–∫–∂–µ –¥–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

## üß™ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ PHP

- ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Handler`, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–∞:
```php
<?php

interface Handler
{
    public function setNext(Handler $handler): Handler;
    public function handle(Request $request): ?string;
}
```

- ‚úÖ –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:
```php
<?php

class ConcreteHandlerA implements Handler
{
    private $nextHandler;

    public function setNext(Handler $handler): Handler
    {
        $this->nextHandler = $handler;
        return $handler;
    }

    public function handle(Request $request): ?string
    {
        if ($request->getType() === 'A') {
            return "ConcreteHandlerA handled the request.";
        }

        if ($this->nextHandler !== null) {
            return $this->nextHandler->handle($request);
        }

        return null;
    }
}

class ConcreteHandlerB implements Handler
{
    private $nextHandler;

    public function setNext(Handler $handler): Handler
    {
        $this->nextHandler = $handler;
        return $handler;
    }

    public function handle(Request $request): ?string
    {
        if ($request->getType() === 'B') {
            return "ConcreteHandlerB handled the request.";
        }

        if ($this->nextHandler !== null) {
            return $this->nextHandler->handle($request);
        }

        return null;
    }
}
```

- ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å `Request`, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –∑–∞–ø—Ä–æ—Å:
```php
<?php

class Request
{
    private $type;

    public function __construct(string $type)
    {
        $this->type = $type;
    }

    public function getType(): string
    {
        return $this->type;
    }
}
```

- ‚úÖ –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ü–µ–ø–æ—á–∫—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø–æ —ç—Ç–æ–π —Ü–µ–ø–æ—á–∫–µ:
```php
<?php

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
$requestA = new Request('A');
$requestB = new Request('B');

$handlerA = new ConcreteHandlerA();
$handlerB = new ConcreteHandlerB();

$handlerA->setNext($handlerB);

$resultA = $handlerA->handle($requestA); // Output: ConcreteHandlerA handled the request.
$resultB = $handlerA->handle($requestB); // Output: ConcreteHandlerB handled the request.
```

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä—è–º–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–º –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º.
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

## ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

- –ú–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å –Ω–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω –Ω–∏ –æ–¥–Ω–∏–º –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.
