## ü§ù –ü–∞—Ç—Ç–µ—Ä–Ω Mediator –Ω–∞ PHP  
_Intermediary, Controller, Mediator, –ü–æ—Å—Ä–µ–¥–Ω–∏–∫_

![](https://refactoring.guru/images/patterns/content/mediator/mediator.png?id=0264bd857a231b6ea2d0c537c092e698)
  
![](https://refactoring.guru/images/patterns/diagrams/mediator/solution1-en.png?id=dd991a5b7830de8d43f82b084e021713)  
**_–≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–∞._**

## ‚úàÔ∏è –ê–Ω–∞–ª–æ–≥–∏—è –∏–∑ –∂–∏–∑–Ω–∏
![](https://refactoring.guru/images/patterns/diagrams/mediator/live-example.png?id=aa1de3cb7b63aa623e63578a1e43399a)  
–ü–∏–ª–æ—Ç—ã —Å–∞–º–æ–ª—ë—Ç–æ–≤ –æ–±—â–∞—é—Ç—Å—è –Ω–µ –Ω–∞–ø—Ä—è–º—É—é, –∞ —á–µ—Ä–µ–∑ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞.  


–ü–∏–ª–æ—Ç—ã —Å–∞–¥—è—â–∏—Ö—Å—è –∏–ª–∏ —É–ª–µ—Ç–∞—é—â–∏—Ö —Å–∞–º–æ–ª—ë—Ç–æ–≤ –Ω–µ –æ–±—â–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é —Å –¥—Ä—É–≥–∏–º–∏ –ø–∏–ª–æ—Ç–∞–º–∏. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–Ω–∏ —Å–≤—è–∑—ã–≤–∞—é—Ç—Å—è —Å –¥–∏—Å–ø–µ—Ç—á–µ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∞–º–æ–ª—ë—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –ë–µ–∑ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ –ø–∏–ª–æ—Ç–∞–º –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –±—ã –≤—Å–µ –≤—Ä–µ–º—è –±—ã—Ç—å –Ω–∞—á–µ–∫—É –∏ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –≤—Å–µ–º–∏ –æ–∫—Ä—É–∂–∞—é—â–∏–º–∏ —Å–∞–º–æ–ª—ë—Ç–∞–º–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –∞ —ç—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –±—ã –∫ —á–∞—Å—Ç—ã–º –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞–º –≤ –Ω–µ–±–µ.  

–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –¥–∏—Å–ø–µ—Ç—á–µ—Ä –Ω–µ –Ω—É–∂–µ–Ω –≤–æ –≤—Ä–µ–º—è –≤—Å–µ–≥–æ –ø–æ–ª—ë—Ç–∞. –û–Ω –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω —Ç–æ–ª—å–∫–æ –≤ –∑–æ–Ω–µ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–Ω–æ–≥–∏—Ö —Å–∞–º–æ–ª—ë—Ç–æ–≤.

## üéØ –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å
- **–°–ª–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –∫–ª–∞—Å—Å—ã –∏–∑-–∑–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ö–∞–æ—Ç–∏—á–Ω—ã—Ö —Å–≤—è–∑–µ–π.** –ü–æ—Å—Ä–µ–¥–Ω–∏–∫ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç —Å–≤—è–∑–∏ –≤ –æ–¥–Ω–æ –º–µ—Å—Ç–æ –∏ —É–ø—Ä–æ—â–∞–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥.
- **–ö–ª–∞—Å—Å –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∑-–∑–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.** –ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –Ω–µ–≥–æ.
- **–ù—É–∂–Ω–æ –º–Ω–æ–≥–æ –ø–æ–¥–∫–ª–∞—Å—Å–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤.** –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–≤—è–∑–∏ –≤ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–µ.

## üß† –û–ø–∏—Å–∞–Ω–∏–µ

–ü–∞—Ç—Ç–µ—Ä–Ω **Mediator** (**–ü–æ—Å—Ä–µ–¥–Ω–∏–∫**) ‚Äî —ç—Ç–æ **–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π** –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –æ–±—ä–µ–∫—Ç–∞–º–∏ –∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º.

## ‚ö° –í –¥–≤—É—Ö —Å–ª–æ–≤–∞—Ö
–û–±—ä–µ–∫—Ç—ã –æ–±—â–∞—é—Ç—Å—è –Ω–µ –Ω–∞–ø—Ä—è–º—É—é, –∞ —á–µ—Ä–µ–∑ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–∞.

## üß≠ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –æ–±—ä–µ–∫—Ç–∞–º–∏.
- –ù—É–∂–Ω–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é.
- –•–æ—Ç–∏—Ç–µ —É–º–µ–Ω—å—à–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

## üí° –ö–ª—é—á–µ–≤—ã–µ –∏–¥–µ–∏
- –£ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–µ—Ç —Å—Å—ã–ª–æ–∫ –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞.
- –ü–æ—Å—Ä–µ–¥–Ω–∏–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.
- –õ–æ–≥–∏–∫—É –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –ª–µ–≥–∫–æ –º–µ–Ω—è—Ç—å –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.

## üß™ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ PHP

### 1) –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Mediator`
```php
<?php

interface Mediator
{
    public function notify(Component $sender, string $event): void;
}
```

### 2) –†–µ–∞–ª–∏–∑–∞—Ü–∏—è `ConcreteMediator`
```php
<?php

class ConcreteMediator implements Mediator
{
    private $component1;
    private $component2;

    public function setComponent1(Component1 $component): void
    {
        $this->component1 = $component;
    }

    public function setComponent2(Component2 $component): void
    {
        $this->component2 = $component;
    }

    public function notify(Component $sender, string $event): void
    {
        if ($sender === $this->component1) {
            echo "Component1 triggers event: $event\n";
            $this->component2->doSomething();
        } elseif ($sender === $this->component2) {
            echo "Component2 triggers event: $event\n";
            $this->component1->doSomething();
        }
    }
}
```

### 3) –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã `Component1` –∏ `Component2`
```php
<?php

class Component1 extends Component {
    public function doSomething(): void {
        echo "Component1 does something\n";
        $this->mediator->notify($this, "event A");
    }
}

class Component2 extends Component {
    public function doSomething(): void {
        echo "Component2 does something\n";
        $this->mediator->notify($this, "event B");
    }
}
```

### 4) –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `Component`
```php
<?php

abstract class Component
{
    protected $mediator;

    public function setMediator(Mediator $mediator): void
    {
        $this->mediator = $mediator;
    }

    abstract public function doSomething(): void;
}
```

### 5) –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞
```php
<?php

$mediator = new ConcreteMediator();

$component1 = new Component1();
$component2 = new Component2();

$component1->setMediator($mediator);
$component2->setMediator($mediator);

$mediator->setComponent1($component1);
$mediator->setComponent2($component2);

$component1->doSomething(); // Output: Component1 does something, Component2 triggers event: event A
$component2->doSomething(); // Output: Component2 does something, Component1 triggers event: event B
```

## üß© –ü—Ä–∏–º–µ—Ä –∏–∑ Design Patterns for Humans
_–ß–∞—Ç-–∫–æ–º–Ω–∞—Ç–∞, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—É—é –æ–±—â–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏._

```php
<?php

$mediator = new ChatRoom();
$john = new User('John', $mediator);
$jane = new User('Jane', $mediator);

$john->send('Hi!');
$jane->send('Hello!');
```

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –£–º–µ–Ω—å—à–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –æ–±—ä–µ–∫—Ç–∞–º–∏, —Ç–∞–∫ –∫–∞–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ.
- –£–ª—É—á—à–∞–µ—Ç —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞.
- –£—Å—Ç—Ä–∞–Ω—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏, –ø–æ–∑–≤–æ–ª—è—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.
- –£–ø—Ä–æ—â–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑—É–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.

## ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

- –ü–æ—Å—Ä–µ–¥–Ω–∏–∫ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–æ–π –æ—Ç–∫–∞–∑–∞, –µ—Å–ª–∏ –æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–º –∏–ª–∏ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω—ã–º.
- –ü–æ—Å—Ä–µ–¥–Ω–∏–∫ –º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ —Ä–∞–∑–¥—É—Ç—å—Å—è.
