## üß© –ü–∞—Ç—Ç–µ—Ä–Ω State –Ω–∞ PHP  
_–°–æ—Å—Ç–æ—è–Ω–∏–µ_

–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ —É –æ–±—ä–µ–∫—Ç–∞ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –æ–Ω –º–µ–Ω—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∏—Ö.

![](https://refactoring.guru/images/patterns/content/state/state-ru.png)


## üì± –ê–Ω–∞–ª–æ–≥–∏—è –∏–∑ –∂–∏–∑–Ω–∏

–í–∞—à —Å–º–∞—Ä—Ç—Ñ–æ–Ω –≤–µ–¥—ë—Ç —Å–µ–±—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è:

- –ö–æ–≥–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥–µ–π—Å—Ç–≤–∏—è–º.
- –ö–æ–≥–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —ç–∫—Ä–∞–Ω—É —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.
- –ö–æ–≥–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω —Ä–∞–∑—Ä—è–∂–µ–Ω, –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —ç–∫—Ä–∞–Ω—É –∑–∞—Ä—è–¥–∫–∏.


## üß† –û–ø–∏—Å–∞–Ω–∏–µ

–ü–∞—Ç—Ç–µ—Ä–Ω **State** (**–°–æ—Å—Ç–æ—è–Ω–∏–µ**) ‚Äî —ç—Ç–æ **–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π** –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç–∞–º –º–µ–Ω—è—Ç—å —Å–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–≤–æ–µ–≥–æ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –ü–∞—Ç—Ç–µ—Ä–Ω State –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É –¥–ª–∏–Ω–Ω—ã–º —Ü–µ–ø–æ—á–∫–∞–º —É—Å–ª–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤, –ø–æ–∑–≤–æ–ª—è—è –≤—ã–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã.

## ‚ö° –í –¥–≤—É—Ö —Å–ª–æ–≤–∞—Ö
–ü–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –º–µ–Ω—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º.

## üß™ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ PHP

- ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `State`, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞:
```php
<?php

interface State
{
    public function handle(Context $context): void;
}
```

- ‚úÖ –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
```php
<?php

class ConcreteStateA implements State
{
    public function handle(Context $context): void
    {
        echo "ConcreteStateA handles the request.\n";
        $context->setState(new ConcreteStateB());
    }
}

class ConcreteStateB implements State
{
    public function handle(Context $context): void
    {
        echo "ConcreteStateB handles the request.\n";
        $context->setState(new ConcreteStateA());
    }
}
```

- ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å `Context`, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–±—ä–µ–∫—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –µ–º—É —Ä–∞–±–æ—Ç—É:
```php
<?php

class Context
{
    private $state;

    public function setState(State $state): void
    {
        $this->state = $state;
    }

    public function request(): void
    {
        $this->state->handle($this);
    }
}
```

- ‚úÖ –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω State –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–∞:
```php
<?php

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
$context = new Context();
$stateA = new ConcreteStateA();
$stateB = new ConcreteStateB();

$context->setState($stateA);
$context->request(); // Output: ConcreteStateA handles the request.

$context->setState($stateB);
$context->request(); // Output: ConcreteStateB handles the request.
```

## üß© –ü—Ä–∏–º–µ—Ä –∏–∑ Design Patterns for Humans
_–¢–µ–ª–µ—Ñ–æ–Ω –º–µ–Ω—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)._

```php
<?php

$phone = new Phone();
$phone->pickUp();
$phone->lock();
```

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –£–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥ –æ–±—ä–µ–∫—Ç–∞, —Ç–∞–∫ –∫–∞–∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –æ–±—ä–µ–∫—Ç—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π.
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —á–µ—Ç–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ—Å—Ç—å –ª–æ–≥–∏–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π.

## ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

- –í–≤–æ–¥–∏—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, —á—Ç–æ –º–æ–∂–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ.
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—ã–º –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –±–µ–∑ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π.
